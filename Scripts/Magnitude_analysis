/*
===============================================================================
Magnitude Analysis
===============================================================================
Purpose:
    - To quantify data and group results by specific dimensions.
    - For understanding data distribution across categories.

SQL Functions Used:
    - Aggregate Functions: SUM(), COUNT(), AVG()
    - GROUP BY, ORDER BY
===============================================================================
*/


-- Find total customers by State

Select		Customer_state,
			Count(customer_id) As Total_customers_per_state
From		Gold.dim_customers_dataset
Group By	customer_state
Order By	Total_customers_per_state Desc;


-- Find total products by category

Select		Product_category_name,
			Count(product_id) As Number_Prod_In_Category
From		Gold.dim_product_dataset
Group by	product_category_name
Order by	Number_Prod_In_Category Desc;


-- What is the average costs in each category

Select		product_category_name,
			AVG(price) As avearage_cost_per_category
From		Gold.fact_order_dataset 
Group by	product_category_name
Order By	avearage_cost_per_category Desc;

-- What is the total revenue generated for each category?

Select		Product_category_name,
			Sum(price) As Total_revenue_per_category
From		Gold.fact_order_dataset
Group By	product_category_name
Order By	Total_revenue_per_category Desc;

-- What is the total revenue generated by each customer?

Select		Customer_id,
			a.customer_key,
			Sum(price) As Revenue_per_customer
From		Gold.fact_order_dataset As a 
	Left Join Gold.dim_customers_dataset As b
		On a.customer_key = b.customer_key
Group by	a.customer_key , customer_id
Order By	Revenue_per_customer Desc;

-- What is the total revenue generated each by top 10 customers?

Select Top		10 
				a.customer_key,
				Customer_id,
				Sum(price) As Revenue_per_customers
From			Gold.fact_order_dataset As a
		Left Join Gold.dim_customers_dataset As b
			On a.customer_key = b.customer_key
Group by		a.customer_key,
				Customer_id
Order By		Revenue_per_customers Desc


-- What is the distribution of Revenue across states?

Select		customer_State,
			Sum(price) As Revenue_per_state
From		Gold.fact_order_dataset As a
			Left Join Gold.dim_customers_dataset As b
				On a.customer_key = b.customer_key
Group by	customer_state
Order By	Revenue_per_state Desc;

---What is the total payment per payment methods

Select		Payment_methods,
			Sum(price) As total_revenue
From		Gold.fact_order_dataset
Group By	Payment_methods
Order By	total_revenue Desc;







